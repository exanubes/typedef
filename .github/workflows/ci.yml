name: CI

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:
  test:
    uses: ./.github/workflows/tests.yml
    with:
      go-version: '1.24.4'
      node-version: '22'

  # Verify builds work (quick check, current platform only)
  build-verify:
    uses: ./.github/workflows/build.yml
    with:
      go-version: '1.24.4'
      build-all-platforms: false

  build-web-verify:
    needs: build-verify
    uses: ./.github/workflows/build-web.yml
    with:
      node-version: '22'
      pnpm-version: '10.11.0'
      upload-artifacts: true  # Upload artifacts for releases
